(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[695],{31199:function(X,E,e){"use strict";var Z=e(22122),h=e(28991),C=e(81253),g=e(67294),m=e(38622),F=["fieldProps","min","proFieldProps","max"],x=function(l,p){var S=l.fieldProps,L=l.min,$=l.proFieldProps,D=l.max,t=(0,C.Z)(l,F);return g.createElement(m.Z,(0,Z.Z)({mode:"edit",valueType:"digit",fieldProps:(0,h.Z)({min:L,max:D},S),ref:p,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:$},t))};E.Z=g.forwardRef(x)},64317:function(X,E,e){"use strict";var Z=e(22122),h=e(28991),C=e(81253),g=e(22270),m=e(67294),F=e(66758),x=e(38622),A=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],l=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],p=m.forwardRef(function(t,B){var U=t.fieldProps,W=t.children,K=t.params,T=t.proFieldProps,G=t.mode,V=t.valueEnum,w=t.request,Y=t.showSearch,y=t.options,N=(0,C.Z)(t,A),M=(0,m.useContext)(F.Z);return m.createElement(x.Z,(0,Z.Z)({mode:"edit",valueEnum:(0,g.h)(V),request:w,params:K,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,h.Z)({options:y,mode:G,showSearch:Y,getPopupContainer:M.getPopupContainer},U),ref:B,proFieldProps:T},N),W)}),S=m.forwardRef(function(t,B){var U=t.fieldProps,W=t.children,K=t.params,T=t.proFieldProps,G=t.mode,V=t.valueEnum,w=t.request,Y=t.options,y=(0,C.Z)(t,l),N=(0,h.Z)({options:Y,mode:G||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},U),M=(0,m.useContext)(F.Z);return m.createElement(x.Z,(0,Z.Z)({mode:"edit",valueEnum:(0,g.h)(V),request:w,params:K,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,h.Z)({getPopupContainer:M.getPopupContainer},N),ref:B,proFieldProps:T},y),W)}),L=p,$=S,D=L;D.SearchSelect=$,D.displayName="ProFormComponent",E.Z=D},94750:function(X,E,e){"use strict";var Z=e(81910),h=e(85893),C=function(m){var F=(0,Z.md)();return(0,h.jsx)(Z.Nv,{accessible:F[m.access],children:m.children})};E.Z=C},94182:function(X,E,e){"use strict";e.r(E),e.d(E,{default:function(){return le}});var Z=e(62350),h=e(24565),C=e(86582),g=e(57663),m=e(71577),F=e(34792),x=e(48086),A=e(11849),l=e(39428),p=e(3182),S=e(69610),L=e(54941),$=e(81306),D=e(80017),t=e(62260),B=e(49101),U=e(1870),W=e(67265),K=e(25590),T=e(67294),G=e(9715),V=e(55843),w=e(2824),Y=e(71975),y=e(5966),N=e(31199),M=e(64317),n=e(85893),ae=function(s){var v,c,d,f,i,r,o=V.Z.useForm(),P=(0,w.Z)(o,1),u=P[0];return(0,n.jsxs)(Y.a,{title:s.values?"\u7F16\u8F91":"\u6DFB\u52A0",form:u,preserve:!1,trigger:s.btn,layout:"horizontal",autoFocusFirstInput:!0,drawerProps:{destroyOnClose:!0},submitTimeout:2e3,onFinish:function(){var O=(0,p.Z)((0,l.Z)().mark(function a(I){var R;return(0,l.Z)().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return I.id=((R=s.values)===null||R===void 0?void 0:R.id)||0,z.abrupt("return",s.onSubmit(I));case 2:case"end":return z.stop()}},a)}));return function(a){return O.apply(this,arguments)}}(),width:"440px",children:[(0,n.jsx)(y.Z,{name:"name",labelCol:{span:5},label:"\u540D\u79F0",rules:[{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}],initialValue:((v=s.values)===null||v===void 0?void 0:v.name)||""}),(0,n.jsx)(N.Z,{name:"mobile",labelCol:{span:5},label:"\u624B\u673A\u53F7",rules:[{required:!0,message:"\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A"}],initialValue:((c=s.values)===null||c===void 0?void 0:c.mobile)||""}),(d=s.values)!==null&&d!==void 0&&d.id?(0,n.jsx)(y.Z.Password,{name:"password",fieldProps:{autoComplete:"new-password"},labelCol:{span:5},label:"\u5BC6\u7801",extra:"\u4E0D\u586B\u5199\u5219\u4E0D\u91CD\u7F6E"}):(0,n.jsx)(y.Z.Password,{name:"password",fieldProps:{autoComplete:"new-password"},labelCol:{span:5},label:"\u5BC6\u7801",rules:[{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A"}]}),s.roleType===1?(0,n.jsx)(M.Z,{labelCol:{span:5},mode:"multiple",name:"machine_id",label:"\u624B\u673A\u914D\u7F6E",rules:[{required:!0,message:"\u624B\u673A\u914D\u7F6E\u4E0D\u80FD\u4E3A\u7A7A"}],initialValue:((f=s.values)===null||f===void 0?void 0:f.machine_id)||[],request:(0,p.Z)((0,l.Z)().mark(function O(){var a,I,R,Q;return(0,l.Z)().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,s.getMachine();case 2:a=b.sent;for(I in a.data)(R=s.values)!==null&&R!==void 0&&(Q=R.machine_id)!==null&&Q!==void 0&&Q.includes(a.data[I].value)&&(a.data[I].disabled=!1);return b.abrupt("return",a.data);case 5:case"end":return b.stop()}},O)}))}):void 0,s.roleType===1?(0,n.jsx)(M.Z,{labelCol:{span:5},name:"type",label:"\u65F6\u957F",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u65F6\u957F"}],initialValue:(i=s.values)===null||i===void 0?void 0:i.type,options:[{label:"3\u5929",value:2},{label:"1\u6708",value:1},{label:"3\u6708",value:3},{label:"1\u5E74",value:0}]}):void 0,(0,n.jsx)(M.Z,{name:"state",options:[{label:"\u5F00\u542F",value:1},{label:"\u5173\u95ED",value:0}],labelCol:{span:5},label:"\u662F\u5426\u5F00\u542F",rules:[{required:!0,message:"\u662F\u5426\u5F00\u542F\u5FC5\u987B\u8BBE\u7F6E"}],initialValue:(r=s.values)===null||r===void 0?void 0:r.state})]})},k=ae,te=e(30381),re=e.n(te),ne=[{title:"ID",dataIndex:"id",search:!1},{title:"\u7528\u6237\u540D\u79F0",dataIndex:"name"},{title:"\u624B\u673A\u53F7",dataIndex:"mobile",renderText:function(s){return"".concat(s)}},{title:"\u65F6\u957F",dataIndex:"type",search:!1,valueEnum:{0:{text:"1\u5E74"},1:{text:"1\u6708"},2:{text:"3\u5929"},3:{text:"3\u6708"}}},{title:"\u72B6\u6001",dataIndex:"state",search:!1,valueEnum:{0:{text:"\u672A\u542F\u7528"},1:{text:"\u5DF2\u542F\u7528"}}},{title:"\u7C7B\u578B",dataIndex:"role_type",search:!1,valueEnum:{0:{text:"\u7BA1\u7406\u5458"},1:{text:"\u4EE3\u7406\u5546"},2:{text:"\u5546\u6237"}}},{title:"\u673A\u5668\u6570\u91CF",dataIndex:"machine_name",search:!1,render:function(s,v){var c;return((c=v.machine_id)===null||c===void 0?void 0:c.length)||0}},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"created_at",valueType:"dateTime",search:!1,render:function(s){return re()(s.props.text*1e3).format("YYYY-MM-DD HH:mm:ss")}}],J=e(81910),se=e(94750),q,_,ee,j,le=(q=window.connectModel("user","@@initialState"),_=Reflect.metadata("design:type",Function),ee=Reflect.metadata("design:paramtypes",[Object]),q(j=_(j=ee(j=function(H){(0,$.Z)(v,H);var s=(0,D.Z)(v);function v(c){var d,f,i;return(0,S.Z)(this,v),i=s.call(this,c),i.actionRef=void 0,i.state={user:(d=i.props.user)===null||d===void 0||(f=d.initialState)===null||f===void 0?void 0:f.currentUser},i.getData=function(){var r=(0,p.Z)((0,l.Z)().mark(function o(P){var u;return(0,l.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,t.Lh)(P);case 2:return u=a.sent,a.abrupt("return",u);case 4:case"end":return a.stop()}},o)}));return function(o){return r.apply(this,arguments)}}(),i.handleUpdate=function(){var r=(0,p.Z)((0,l.Z)().mark(function o(P){var u;return(0,l.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,t.Nq)((0,A.Z)({},P));case 2:if(u=a.sent,!u.success){a.next=7;break}return i.actionRef.current.reload(),x.ZP.success(u.msg),a.abrupt("return",!0);case 7:case"end":return a.stop()}},o)}));return function(o){return r.apply(this,arguments)}}(),i.handleAdd=function(){var r=(0,p.Z)((0,l.Z)().mark(function o(P){var u;return(0,l.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,t.cn)((0,A.Z)({},P));case 2:if(u=a.sent,!u.success){a.next=7;break}return i.actionRef.current.reload(),x.ZP.success(u.msg),a.abrupt("return",!0);case 7:case"end":return a.stop()}},o)}));return function(o){return r.apply(this,arguments)}}(),i.handleRemove=function(){var r=(0,p.Z)((0,l.Z)().mark(function o(P){var u;return(0,l.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,t.kX)({id:P});case 2:u=a.sent,console.log(u),u.success&&(i.actionRef.current.reload(),x.ZP.success(u.msg));case 5:case"end":return a.stop()}},o)}));return function(o){return r.apply(this,arguments)}}(),i.actionRef=T.createRef(),i}return(0,L.Z)(v,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var d=this;return(0,n.jsx)(W.ZP,{children:(0,n.jsx)(K.Z,{actionRef:this.actionRef,rowKey:"id",search:{labelWidth:66},toolBarRender:function(){return[(0,n.jsx)(k,{btn:(0,n.jsxs)(m.Z,{type:"primary",children:[(0,n.jsx)(B.Z,{}),"\u6DFB\u52A0"]}),onSubmit:d.handleAdd,values:void 0,roleType:d.state.user.role_type,getMachine:t.f_})]},request:this.getData,columns:[].concat((0,C.Z)(ne),[{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",render:function(i,r){return[(0,n.jsx)("a",{onClick:function(){r.role_type===2?J.m8.push("../machine/List?user_id="+r.id):r.role_type===1&&J.m8.push("../machine/List?user_id=0&agent_user_id="+r.id)},children:"\u673A\u5668\u5217\u8868"},"machine_"+r.id),(0,n.jsx)(se.Z,{access:"Api_statisticList",children:(0,n.jsx)("a",{onClick:function(){return J.m8.push("../statistic/List?user_id="+r.id)},children:"\u7EDF\u8BA1\u6570\u636E"},"machine_statistic_"+r.id)},"statistic_"+r.id),(0,n.jsx)(k,{btn:(0,n.jsx)("a",{children:"\u4FEE\u6539"},"update_"+r.id),onSubmit:d.handleUpdate,values:r,roleType:d.state.user.role_type,getMachine:t.f_},"update__"+r.id),d.state.user.id!==r.id?(0,n.jsxs)(h.Z,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",icon:(0,n.jsx)(U.Z,{style:{color:"red"}}),onConfirm:function(){return d.handleRemove(r.id)},children:[" ",(0,n.jsx)("a",{children:"\u5220\u9664"},"delete_"+r.id)]},"delete__"+r.id):void 0]}}])})})}}]),v}(T.Component))||j)||j)||j)}}]);
